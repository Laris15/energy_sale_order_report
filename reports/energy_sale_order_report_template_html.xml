<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="energy_report_saleorder_document">
        <style>
            .page {
            font-family: Helvetica, sans-serif;
            font-size: 12px;
            color: #363636;
            box-sizing: border-box;
            max-width: 800px;
            margin: 0 auto;
            }
            .body {
            font-family: Helvetica, sans-serif;
            font-size: 12px;
            color: #363636;
            box-sizing: border-box;
            max-width: 800px;
            margin: 0 auto;
            }

            #image img {
            margin: 2px;
            margin-left: -35px;
            }

            .adresse__1 {
            width: 100%;
            }

            .adresse__1 tr td {
            margin: 2px;
            font-size: medium;
            }

            .adresse__2 tr td {
            margin: 2px;
            font-size: medium;
            }

            .adresse__2 {
            margin-left: 400px;
            }

            .bande th {
            text-align: left;
            padding: 0.5rem 0.5rem;
            height: 40px;
            width: 100%;
            background-color: #008000;
            color: white;
            font-size: medium;
            }

            .adresse__3 tr.num {
            font-weight: bold;
            text-align: right;
            font-size: medium;
            padding-right: 0.5rem 0.5rem;
            }

            .adresse__3 tr.text {
            font-weight: bold;
            text-align: left;
            font-size: 14px;

            }

            .adresse__3 tr.operation {
            font-weight: bold;
            text-align: left;
            font-size: 15px;
            }

            .footer tr.first {
            text-align: center;
            font-size: medium;
            }

            .footer {
            margin: 20px;

            }

            .page p {
            text-align: center;
            font-size: large;
            color: gray;
            }

            .account {
            width: 100%;
            }

            .table__header {
            background-color: #008000;
            color: white;
            }

            .table__header th {
            padding: 0.5rem 0.5rem;
            text-align: left;
            }

            .align__right {
            text-align: right !important;
            }

            .align__left {
            text-align: left !important;
            }

            .table__row td {
            padding: 0.5rem 0.5rem;
            border-bottom: 1.25px solid #f7f7f7;
            }

            .table__row td.number {
            text-align: right;
            }

            .table__row td.text {
            text-align: left;
            }

            .bottom__text {
            font-size: 12px;
            padding: 1rem 0;
            border-bottom: 1.5px solid black;
            color: #363636;
            line-height: 1.125;
            }

            .total {
            margin-left: 55%;
            width: 45%;
            margin-top: 25px;
            }

            .bold {
            font-weight: bold;
            }

            tr.top__bold td {
            border-top: 1.5px solid black;
            }

            tr.bottom__bold td {
            border-bottom: 1.5px solid black;
            }

            span {
            font-weight: bold;
            font-size: 13px;
            }
            .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: grey;
            color: white;
            }
        </style>
        <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)"/>
        <div class="page" align="center">
            <div class="header" t-att-style="report_header_style">
                <div class="row zero_min_height">
                    <img src="/energy_sale_order_report/static/description/logo.png" alt="Image is not loading"
                         style="height:120px;
                                width: 150px;"/>
                </div>
            </div>
            <div class="body">
                <table class="adresse__1" cellspacing="0">
                    <tr t-if="doc.company_id.name">
                        <span t-field="doc.company_id.name"/>
                    </tr>
                    <tr t-if="doc.company_id.street">
                        <td>
                            <span t-field="doc.company_id.street"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span t-field="doc.company_id.zip"/>
                            -
                            <span t-field="doc.company_id.city"/>
                        </td>
                    </tr>
                    <tr t-if="doc.company_id.phone">
                        <td>Tél :
                            <span class="o_force_ltr" t-field="doc.company_id.phone"/>
                        </td>
                    </tr>
                    <tr t-if="doc.company_id.email">
                        <td>
                            <span t-field="doc.company_id.email"/>
                        </td>
                    </tr>
                </table>
                <table class="adresse__2" cellspacing="0">
                    <tr t-if="doc.partner_id.name">
                        <td>
                            <span t-field="doc.partner_id.name"/>
                        </td>
                    </tr>
                    <tr t-if="doc.partner_id.street">
                        <td>
                            <span t-field="doc.partner_id.street"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span t-field="doc.partner_id.zip"/>
                            <span t-field="doc.partner_id.city"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span t-field="doc.partner_id.country_id"/>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span t-field="doc.partner_id.email"/>
                        </td>
                    </tr>
                    <tr t-if="doc.partner_id.siret">
                        <td>SIREN:
                            <span t-field="doc.partner_id.siret"/>
                        </td>
                    </tr>
                </table>
                <table class="bande">
                    <th colspan="2">Devis</th>
                    <th></th>
                </table>
                <table class="adresse__3">
                    <tr class="num">
                        <td>N° :
                            <span t-field="doc.name"/>
                        </td>
                    </tr>
                    <tr class="num">
                        <td>Date du devis :
                            <span class="m-0" t-field="doc.date_order"/>
                        </td>
                    </tr>
                    <tr class="text">
                        <td>ISOLATION D'UN RESEAU HYDRAULIQUE D'EAU CHAUDE SANITAIRE ET CHAUFFAGE HORS VOLUME CHAUFFE
                        </td>
                    </tr>
                    <tr>
                        <td>Dépose et enlèvement de l'ancien calorifuge. Pose d'un calorifuge neuf conforme à la
                            réglementation
                            RT 2012
                            avec un isolant de classe supérieureou égal à 4 selon
                            la norme NF en 12 828+A1 : 2014. Réseau en sous-sol / cave/ parking / parties communes.
                        </td>
                    </tr>
                    <tr class="operation">
                        <td>Operation: BAT-TH-146</td>
                    </tr>
                </table>
                <table class="account" cellspacing="0">
                    <thead>
                        <tr class="table__header">
                            <th>Adresse d'intervention</th>
                            <th>Localisation</th>
                            <th class="align__right">Quantité</th>
                            <th class="align__right">Prix unitaire</th>
                            <th class="align__right">Montant</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-set="current_subtotal" t-value="0"/>

                        <t t-foreach="doc.order_line" t-as="line">
                            <tr class="table__row">
                                <td class="text">
                                    <span t-field="line.address"/>
                                </td>
                                <td class="text">
                                    <span t-field="line.localisation"/>
                                </td>
                                <td class="number">
                                    <span t-field="line.product_uom_qty"/>
                                    <span t-field="line.product_uom"/>
                                </td>
                                <td class="number">
                                    <span t-field="line.price_unit"/>
                                    €
                                </td>
                                <td class="number">
                                    <span t-field="line.price_subtotal"/>
                                    €
                                </td>
                            </tr>
                        </t>
                    </tbody>

                    <tr class="table__row"></tr>
                </table>
                <table cellspacing="0" class="total">
                    <tr class="table__row top__bold">
                        <td class="bold">TOTAL HT</td>
                        <td class="number">
                            <span t-field="doc.amount_untaxed"/>
                            €
                        </td>
                    </tr>
                    <tr class="table__row bottom__bold">
                        <td>TVA 20%</td>
                        <td class="number">
                            <span t-field="doc.amount_tax"/>
                            €
                        </td>
                    </tr>
                    <tr class="table__row bottom__bold">
                        <td class="bold">Total T.T.C</td>
                        <td class="number">
                            <span t-field="doc.amount_total"/>
                            €
                        </td>
                    </tr>
                    <tr class="table__row bottom__bold">
                        <td class="bold">Prime Certificat d'Economie d'Energie</td>
                        <td class="number">-
                            <span t-field="doc.amount_total"/>
                            €
                        </td>
                    </tr>
                    <tr class="table__row">
                        <td class="bold">NET A PAYER</td>
                        <td class="number bold">0,00€</td>
                    </tr>
                </table>
                <div class="bottom__text">
                    Poste, hors volume chauffé, réseau en sous-sol/cave ou vide sanitaire. Matériel ou installation:
                    Dépose
                    ou
                    enlèvement de l'ancien calorifuge Pose d'un calorifuge
                    neuf de marque ISOVER, Type U PROTECT PIPE SECTION ALU 2 conforme à la réglementation RT2012, avec
                    un
                    isolant de
                    classe supérieure ou égale à 4, selon la
                    norme NF en 12 828 +A1: 2014. Consommable (masque à poussière, combinaison, sac à ordures, polyane
                    pour
                    protection
                    des sols). Fourniture et posse de coquille
                    de laine de rôche revêtue d'aluminium, joints colés par adhésif aluminium.Lépaisseur installée, soit
                    20,
                    30,40,50,60,70 mm sera déterminée selon le diamètre de la
                    tuyauterie, par la conformité en classe 4. Mise en sacs à gravats et évacuation, finition,
                    rangement,replis
                    du
                    chantier.
                    Les travaux ou prestations, objet du présent document, donneront lieu à une contribution financière
                    VERIGO,
                    versée
                    par VERTIGO dans le cadre de son rôle
                    incitatif, sous forme de prime, directement ou via son(ses) mandataire(s), sous réserve de
                    l'engagement
                    de
                    fournir
                    exclusivement à VERTIGO, les documents
                    nécessaires à la valorisation des opérations ou titre du dispositif des Certificat d'Economies
                    d'Energie
                    et
                    sous
                    réserve de la validation de l'éligibilité du dossier par
                    VERTIGO puis par l'autorité administrative compétente. Le montant de cette contribution financière,
                    hors
                    champ
                    d'application de la T.V.A, est susceptible de varier
                    en fonction des travaux effectivement réalisés et du volume des CEE attribués à l'opération et est
                    estimé à
                    :
                    <span>
                        <span t-field="doc.amount_total"/>
                        €
                    </span>
                    Le client accepte que la société ENERGY de FRANCE, mandataire de VERTIGO collecte et traite ces
                    données
                    à
                    caractère
                    personnel pour les besoins du dépot d'un
                    dossier CEE sur le registre EMMY conformément aux dispositions réglementaires en vigueur et qu'il
                    communique
                    ces
                    données à VERTIGO à des fins de contrôle de
                    la conformité des opérations réalisés chez le client. VERTIGO s'engage à respecter la réglementation
                    française et
                    européenne relative à la protection des données à
                    caractère personnel
                </div>
                <table class="adress" cellspacing="0">
                    <tr>
                        <td>
                            <div class="bloc1">
                                <u>Bon pour accord le :</u>
                            </div>
                        </td>
                        <td>
                            <div class="bloc2">
                                <u>Nom et Prénom</u>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="bloc1">
                                <u>Signature et Cachet :</u>
                            </div>
                        </td>
                        <td>
                            <div class="bloc2">
                                <u>Fonction :</u>
                            </div>
                        </td>
                    </tr>
                </table>
                <div class="middle"></div>
            </div>
            <div class="footer">
                <t t-call="energy_sale_order_report.report_footer"/>
            </div>
        </div>


    </template>

    <template id="report_footer">
        <table class="footer">
            <tr class="first">
                <td>
                    <span t-field="doc.company_id.name"/>
                    -
                    <span t-field="doc.company_id.street"/>,
                    <span t-field="doc.company_id.zip"/>
                    <span t-field="doc.company_id.city"/>
                    - SARL au Capital de 100 000€ -
                </td>
            </tr>
            <tr class="first">
                <td>SIRET <span t-field="doc.company_id.siret"/>
                    <span t-field="doc.company_id.company_registry"/>
                    - Code APE <span t-field="doc.company_id.ape"/>
                </td>
            </tr>
            <tr class="first">
                <td>Tél :
                    <span t-field="doc.company_id.phone"/>
                    - Portable : <span t-field="doc.company_id.partner_id.mobile"/>
                    - <span t-field="doc.company_id.email"/>
                </td>
            </tr>
        </table>
        <div t-if="report_type == 'pdf'" class="text-muted">
            Page:
            <span class="page"/>
            /
            <span class="topage"/>
        </div>
    </template>

    <template id="energy_report_saleorder">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="doc">
                <t t-call="energy_sale_order_report.energy_report_saleorder_document" t-lang="doc.partner_id.lang"/>
            </t>
        </t>
    </template>
</odoo>
